# Fog Compute Production Environment Configuration
# Copy this file to .env and fill in actual values
# NEVER commit the actual .env file to version control!

# =============================================================================
# CRITICAL SECURITY SETTINGS
# =============================================================================

# JWT Secret Key - Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# MUST be at least 32 characters, random, and unique per environment
SECRET_KEY=CHANGE_ME_TO_RANDOM_256_BIT_STRING

# Database Credentials
# Use strong passwords (16+ chars, mixed case, numbers, symbols)
DATABASE_URL=postgresql+asyncpg://fog_user:CHANGE_ME_STRONG_PASSWORD@postgres:5432/fog_compute
POSTGRES_USER=fog_user
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_DB=fog_compute

# Redis Password (for caching and rate limiting)
REDIS_PASSWORD=CHANGE_ME_STRONG_REDIS_PASSWORD
REDIS_URL=redis://:CHANGE_ME_STRONG_REDIS_PASSWORD@redis:6379/0

# =============================================================================
# API SERVER CONFIGURATION
# =============================================================================

API_HOST=0.0.0.0
API_PORT=8000
API_TITLE=Fog Compute Backend API
API_VERSION=1.0.0

# Environment (development, staging, production)
ENVIRONMENT=production

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Comma-separated list of allowed origins (be restrictive in production!)
CORS_ORIGINS=https://yourdomain.com,https://app.yourdomain.com

# =============================================================================
# AUTHENTICATION & AUTHORIZATION
# =============================================================================

# JWT token expiration (in minutes)
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Refresh token expiration (in days)
REFRESH_TOKEN_EXPIRE_DAYS=7

# Password requirements
MIN_PASSWORD_LENGTH=12
REQUIRE_UPPERCASE=true
REQUIRE_LOWERCASE=true
REQUIRE_DIGITS=true
REQUIRE_SPECIAL_CHARS=true

# Account lockout settings
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate limits (requests per minute)
RATE_LIMIT_DEFAULT=60
RATE_LIMIT_AUTH=10
RATE_LIMIT_WRITE=30
RATE_LIMIT_READ=100
RATE_LIMIT_ADMIN=200

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# Betanet (Rust mixnet service)
BETANET_URL=http://betanet:9000
BETANET_TIMEOUT=10

# =============================================================================
# MONITORING & LOGGING
# =============================================================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Structured logging
ENABLE_JSON_LOGGING=true

# Prometheus metrics
METRICS_ENABLED=true
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_STRONG_GRAFANA_PASSWORD

# Sentry (error tracking)
SENTRY_DSN=https://your_sentry_dsn@sentry.io/project_id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================

WS_HEARTBEAT_INTERVAL=30
WS_MESSAGE_QUEUE_SIZE=100
WS_MAX_CONNECTIONS=1000

# =============================================================================
# CACHING
# =============================================================================

ENABLE_CACHE=true
CACHE_TTL=300
CACHE_MAX_SIZE=10000

# =============================================================================
# SECURITY HEADERS
# =============================================================================

# HTTPS enforcement
FORCE_HTTPS=true

# Content Security Policy
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data: https:
CSP_CONNECT_SRC='self' wss:

# =============================================================================
# FILE UPLOAD (if implemented)
# =============================================================================

MAX_UPLOAD_SIZE=10485760  # 10 MB in bytes
ALLOWED_FILE_EXTENSIONS=.jpg,.jpeg,.png,.pdf,.txt
UPLOAD_DIR=/app/uploads

# =============================================================================
# EMAIL NOTIFICATIONS (if implemented)
# =============================================================================

SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@yourdomain.com
SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD
SMTP_FROM_EMAIL=noreply@yourdomain.com
SMTP_FROM_NAME=Fog Compute

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=fog-compute-backups
BACKUP_S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=CHANGE_ME_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=CHANGE_ME_AWS_SECRET_KEY

# =============================================================================
# BETANET CONFIGURATION
# =============================================================================

BETANET_NUM_MIXNODES=5
BETANET_CIRCUIT_HOPS=3
BETANET_DELAY_MEAN=2.0
BETANET_DELAY_STDDEV=0.5

# =============================================================================
# FEATURE FLAGS
# =============================================================================

ENABLE_BITCHAT=true
ENABLE_IDLE_COMPUTE=true
ENABLE_TOKENOMICS=true
ENABLE_SCHEDULER=true
ENABLE_P2P=true

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Worker processes
WORKERS=4
WORKER_CONNECTIONS=1000

# Request timeouts
REQUEST_TIMEOUT=30
KEEPALIVE_TIMEOUT=5

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================

SSL_CERT_PATH=/etc/ssl/certs/fog-compute.crt
SSL_KEY_PATH=/etc/ssl/private/fog-compute.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Let's Encrypt settings
LETSENCRYPT_EMAIL=admin@yourdomain.com
LETSENCRYPT_DOMAIN=yourdomain.com,app.yourdomain.com

# =============================================================================
# PRODUCTION CHECKS
# =============================================================================

# These will prevent startup if not properly configured in production
REQUIRE_HTTPS=true
REQUIRE_STRONG_SECRETS=true
REQUIRE_VALID_CORS=true

# =============================================================================
# DEBUGGING (disable in production!)
# =============================================================================

DEBUG=false
RELOAD=false
PROFILING_ENABLED=false
